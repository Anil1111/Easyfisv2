@{
    var id = Request.QueryString["id"];
}
<!DOCTYPE html>
<html>
<head>
    <!-- Meta -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta name="description" content="Some slide and push menu demos using CSS3 transitions.">

    <!-- Title of the Page -->
    <title>Software - Journal Voucher</title>

    <!-- CSS StyleSheets-->
    @Styles.Render("~/Font-Awesome/css")
    @Styles.Render("~/Content/Software-css")
    @Styles.Render("~/WijmoCSS/Wijmo-css")
</head>
<body>
    <div id="wrapper" class="wrapper">
        <!-- Header -->
        @Html.Partial("_SoftwareHeader")

        <!-- Section -->
        <section>
            <br /><br /><br />
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <h4><img src='~/images/Icons/iJournal.png'> Journal Voucher - Detail</h4>
                    </div>
                </div>
                <div class="row">
                    <hr />
                    <div class="col-md-6">
                        <h4 id="companyDetailLabel">New Journal Voucher</h4>
                    </div>
                    <div class="col-md-6" align="right">
                        <button class="btn btn-primary" id="cmdAddJournalVoucher" onclick="cmdJournalVoucherAddButton_OnClick()"><i class="fa fa-save"></i> Save</button>
                        <button class="btn btn-success" id="cmdUpdateJournalVoucher" onclick="cmdJournalVoucherUpdateButton_OnClick()"><i class="fa fa-save"></i> Update and Save</button>
                        <a href="@Url.Action("JournalVoucher", "Software")" class="btn btn-danger"><i class="fa fa-times"></i> Close</a>
                    </div>
                </div>
                @*<hr />*@
                <div class="well">
                    <form id="journalVoucherDetailForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Branch:</label>
                                    <div id="branch_Id" class="comboBox-wide"></div>

                                    <input type="text" id="branch_Id_data" class="requiredJournalVoucher" required />
                                    <input type="text" id="branch_selectedValue" />
                                </div>
                                <div class="form-group">
                                    <label>Journal Voucher Number:</label>
                                    <input type="text" class="form-control requiredJournalVoucher" id="journalVoucher_No">
                                </div>
                                <div class="form-group">
                                    <label>Journal Voucher Date:</label>

                                    <div id="journalVoucher_Date" class="comboBox-wide"></div>
                                    <input type="text" id="journalVoucher_date_Data" required />
                                </div>
                                <div class="form-group">
                                    <label>Particulars:</label>
                                    <input type="text" id="journalVoucher_Particulars" class="form-control requiredJournalVoucher">
                                </div>
                                <div class="form-group">
                                    <label>Manual Journal Voucher Number:</label>
                                    <input type="text" id="manual_JournalVoucher_No" class="form-control requiredJournalVoucher">
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Prepared by:</label>
                                    <div id="preparedByUserId" class="comboBox-wide"></div>

                                    <input type="text" id="preparedByUserId_Data" class="requiredJournalVoucher" required />
                                    <input type="text" id="preparedByUserId_selectedValue" />
                                </div>
                                <div class="form-group">
                                    <label>Checked by:</label>
                                    <div id="checkedByUserId" class="comboBox-wide"></div>

                                    <input type="text" id="checkedByUserId_Data" class="requiredJournalVoucher" required />
                                    <input type="text" id="checkedByUserId_selectedValue" />
                                </div>
                                <div class="form-group">
                                    <label>Approved by:</label>
                                    <div id="approvedByUserId" class="comboBox-wide"></div>

                                    <input type="text" id="approvedByUserId_Data" class="requiredJournalVoucher" required />
                                    <input type="text" id="approvedByUserId_selectedValue" />
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <hr class="divider" />
                <!-- Branch List -->
                <div id="JournalVoucherLineList">
                    <div class="row">
                        <div class="col-lg-12">
                            <h4 id="journalVoucherNameLabel">Journal Voucher Line (Empty)</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4">
                            <div class="input-group">
                                <span class="input-group-btn">
                                    <button class="btn btn-default" type="button" readonly>
                                        <i class="fa fa-search"></i>
                                    </button>
                                </span>
                                <input type="text" class="form-control" id="InputFilterJournalVoucher" placeholder="Search Journal Voucher Number">
                            </div>
                        </div>
                        <div class="col-lg-8">
                            <button type="submit" class="btn btn-primary pull-right" id="cmdJournalVoucherLineAddJournalVoucherLineButton" onclick="cmdJournalVoucherLineAddJournalVoucherLineButton_OnClick()"><i class="fa fa-plus"></i> Add</button>
                        </div>
                    </div>
                    <br />
                    <div class="row" align="left">
                        <div class="col-lg-12">
                            <div id="JournalVoucherLineGrid" class="grid" align="left"></div>
                        </div>
                    </div>
                    <br />
                    <div class="row">
                        <div class="btn-group col-md-7" id="naviagtionPageGridJournalVoucherLine">
                            <button type="button" class="btn btn-default" id="btnMoveToFirstPageGridJournalVoucherLine">
                                <span class="glyphicon glyphicon-fast-backward"></span>
                            </button>
                            <button type="button" class="btn btn-default" id="btnMoveToPreviousPageGridJournalVoucherLine">
                                <span class="glyphicon glyphicon-step-backward"></span>
                            </button>
                            <button type="button" class="btn btn-default" disabled style="width: 100px" id="btnCurrentPageGridJournalVoucherLine"></button>
                            <button type="button" class="btn btn-default" id="btnMoveToNextPageGridJournalVoucherLine">
                                <span class="glyphicon glyphicon-step-forward"></span>
                            </button>
                            <button type="button" class="btn btn-default" id="btnMoveToLastPageGridJournalVoucherLine">
                                <span class="glyphicon glyphicon-fast-forward"></span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        @Html.Partial("_SoftwareFooter")
    </div>

    <!-- SideBar Menu -->
    @Html.Partial("_SoftwareSideBarMenu")

    <div id="c-mask" class="c-mask"></div><!-- /c-mask -->
    <!-- Scripts JavaScripts -->
    @Scripts.Render("~/Scripts/Software-js")
    @Scripts.Render("~/WijmoScripts/Wijmo-js")
    <script type="text/javascript">
        // ================
        // Global Variables
        // ================
        var journalVouchers;
        var journalVoucherGrid;

        var branches;
        var cboBranch;

        var journalVoucherDate;

        var users;
        var cboUserPreparedBy;
        var cboUserCheckedBy;
        var cboUserApprovedBy;

        var btnFirstPageGridJournalVoucher;
        var btnPreviousPageGridJournalVoucher;
        var btnNextPageGridJournalVoucher;
        var btnLastPageGridJournalVoucher;
        var btnCurrentPageGridJournalVoucher;

        // ========================
        // GET Branch for Combo Box
        // ========================
        function getBranchesoForComboBox() {
            branches = new wijmo.collections.ObservableArray();
            $.ajax({
                url: '/api/listBranch',
                cache: false,
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                data: {},
                success: function (results) {
                    if (results.length > 0) {
                        for (i = 0; i < results.length; i++) {
                            branches.push({
                                BranchId: results[i]["Id"],
                                BranchBranch: results[i]["Branch"]
                            });
                        }
                        createCboBranch(branches);
                    }
                }
            }).fail(function (xhr, textStatus, err) {
                alert(err);
            }
            );
        }

        // ======================
        // Combo Box for Branches
        // ======--==============
        function createCboBranch(branches) {
            var branchCollections = new wijmo.collections.CollectionView(branches);
            var branchList = new Array();
            for (var i = 0; i < branchCollections.items.length; i++) {
                branchList.push(branchCollections.items[i].BranchBranch);
            }

            cboBranch.dispose();
            cboBranch = new wijmo.input.ComboBox('#branch_Id', {
                placeholder: "Select Branch",
                itemsSource: branchList,
                isEditable: false,
                required: false,
                selectedValue: document.getElementById('branch_selectedValue').value.toString(),
                onSelectedIndexChanged: function () {
                    console.log(branchCollections.items[this.selectedIndex].BranchId);
                    $("#branch_Id_data").val(branchCollections.items[this.selectedIndex].BranchId);
                }
            });
        }

        // =======================
        // GET Users for Combo Box
        // =======================
        function getUsersForComboBox() {
            users = new wijmo.collections.ObservableArray();
            $.ajax({
                url: '/api/listUser',
                cache: false,
                type: 'GET',
                contentType: 'application/json; charset=utf-8',
                data: {},
                success: function (results) {
                    if (results.length > 0) {
                        for (i = 0; i < results.length; i++) {
                            users.push({
                                UserId: results[i]["Id"],
                                UserFirstName: results[i]["FirstName"],
                                UserLastName: results[i]["LastName"],
                                UserUserName: results[i]["UserName"],
                                UserEmail: results[i]["Email"]
                            });
                        }
                        createCboUserPreparedBy(users)
                        createCboUserCheckedBy(users);
                        createCboUserApprovedBy(users);
                    }
                }
            }).fail(function (xhr, textStatus, err) {
                alert(err);
            }
            );
        }

        // =================================
        // Combo Box for Users - Prepared By
        // =================================
        function createCboUserPreparedBy(users) {
            var usersCollection = new wijmo.collections.CollectionView(users);
            var userList = new Array();
            for (var i = 0; i < usersCollection.items.length; i++) {
                userList.push(usersCollection.items[i].UserUserName);
            }

            cboUserPreparedBy.dispose();
            cboUserPreparedBy = new wijmo.input.ComboBox('#preparedByUserId', {
                placeholder: "Select User",
                itemsSource: userList,
                isEditable: false,
                required: false,
                selectedValue: document.getElementById('preparedByUserId_selectedValue').value.toString(),
                onSelectedIndexChanged: function () {
                    $("#preparedByUserId_Data").val(usersCollection.items[this.selectedIndex].UserId);
                }
            });
        }

        // ================================
        // Combo Box for Users - Checked By
        // ================================
        function createCboUserCheckedBy(users) {
            var usersCollection = new wijmo.collections.CollectionView(users);
            var userList = new Array();
            for (var i = 0; i < usersCollection.items.length; i++) {
                userList.push(usersCollection.items[i].UserUserName);
            }

            cboUserCheckedBy.dispose();
            cboUserCheckedBy = new wijmo.input.ComboBox('#checkedByUserId', {
                placeholder: "Select User",
                itemsSource: userList,
                isEditable: false,
                required: false,
                selectedValue: document.getElementById('checkedByUserId_selectedValue').value.toString(),
                onSelectedIndexChanged: function () {
                    $("#checkedByUserId_Data").val(usersCollection.items[this.selectedIndex].UserId);
                }
            });
        }

        // ==================================
        // Combo Box for Users - Approved By
        // ==================================
        function createCboUserApprovedBy(users) {
            var usersCollection = new wijmo.collections.CollectionView(users);
            var userList = new Array();
            for (var i = 0; i < usersCollection.items.length; i++) {
                userList.push(usersCollection.items[i].UserUserName);
            }

            cboUserApprovedBy.dispose();
            cboUserApprovedBy = new wijmo.input.ComboBox('#approvedByUserId', {
                placeholder: "Select User",
                itemsSource: userList,
                isEditable: false,
                required: false,
                selectedValue: document.getElementById('approvedByUserId_selectedValue').value.toString(),
                onSelectedIndexChanged: function () {
                    $("#approvedByUserId_Data").val(usersCollection.items[this.selectedIndex].UserId);
                }
            });
        }

        $(document).ready(function () {
            document.getElementById('currentPage').innerHTML = '<a href="@Url.Action("Index", "Software")" class="currentPageLinkCustom">Main Menu</a> ' + ' / ' + '<a href="@Url.Action("JournalVoucher", "Software")" class="currentPageLinkCustom">Journal Voucher</a> ' + ' / Journal Voucher Detail';

            var Id = @id;
            if(Id == 0) {
                $("#cmdUpdateJournalVoucher").hide();

            } else {
                $("#cmdAddJournalVoucher").hide();
            }

            getUsersForComboBox();
            getBranchesoForComboBox();

            cboBranch = new wijmo.input.ComboBox('#branch_Id');

            journalVoucherDate = new wijmo.input.InputDate('#journalVoucher_Date', {
                format: 'MM/dd/yyyy',
                value: new Date()
            });

            cboUserPreparedBy = new wijmo.input.ComboBox('#preparedByUserId');
            cboUserCheckedBy = new wijmo.input.ComboBox('#checkedByUserId');
            cboUserApprovedBy = new wijmo.input.ComboBox('#approvedByUserId');

            //journalVoucherDate.dispose();
            //journalVoucherDate = new wijmo.input.InputDate('#journalVoucher_Date', {
            //    format: 'MM/dd/yyyy',
            //    value: currentDate,
            //    mask: '99/99/9999',
            //    onValueChanged: function () {
            //        document.getElementById('journalVoucher_Date_Data').value = this.value.toString("yyyy-MM-dd");
            //    }
            //});

        });
    </script>
</body>
</html>